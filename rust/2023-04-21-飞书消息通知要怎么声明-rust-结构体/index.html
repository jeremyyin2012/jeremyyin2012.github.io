<!doctype html>
<html lang="zh-cn">


    <head>

        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">


<meta name="generator" content="Hugo 0.85.0" />

        <title>飞书消息通知要怎么声明 Rust 结构体 | Jeremy&#39;s blog</title>

        

        <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="/mdb/css/mdb.min.css">
<link rel="stylesheet" href="/assets/evil-icons.min.css">




<link rel="apple-touch-icon" sizes="57x57" href="/jeremy/ico/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/jeremy/ico/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/jeremy/ico/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/jeremy/ico/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/jeremy/ico/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/jeremy/ico/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/jeremy/ico/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/jeremy/ico/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/jeremy/ico/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/jeremy/ico/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/jeremy/ico/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/jeremy/ico/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/jeremy/ico/favicon-16x16.png">
<link rel="manifest" href="/jeremy/ico/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/jeremy/ico/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">



<link rel="icon" href="/static/jeremy/ico/favicon.ico">



<link rel="stylesheet" href="/jeremy/css/main.css">

    </head>


    
    <body>

        <nav class="navbar navbar-expand-md navbar-light bg-light">
    <div class="container">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
                data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <a class="navbar-brand" href="/">Jeremy&#39;s blog</a>


        <div class="collapse navbar-collapse" id="navbarSupportedContent">


            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/">Home</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/post/">Post</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/note/">Note</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/python/">Python</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/rust/">Rust</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/tornado/">Tornado</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/saleor/">Saleor</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/advertisement/">Advertisement</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/about/">About</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/index.xml">RSS</a>
                </li>


            </ul>
        </div>
    </div>
</nav>



        <div class="container" style="padding-top: 2rem">
                <div class="row">
                    <div class="col-sm-12">
                            

    <article>
        <h1>飞书消息通知要怎么声明 Rust 结构体</h1>
        <hr>
        <p>在企业服务这一板块，除了钉钉、企业微信，还有飞书，如果你要是在做一个与各大平台对接的产品，基本上必然少不了要对接各个平台的消息通知。</p>
<p>所以今天来简单看看飞书的消息通知在 Rust 中又会怎样声明数据结构。</p>
<p>飞书的消息格式是三大平台中形式最为丰富结构最为复杂的，无论是在技术领域还是在某些领域，后来者居上始终是一条铁律，如果一个后来者做不到超越前者，而如果仅仅只是跟随或者受到了前者的牵绊，那么就始终是坐不上头把交椅的。</p>
<p>而这个超越，不是说功能做的多么地复杂功能有多么地多，而是最终的客户体验的全面超越。支持做到客户体验的超越，背后是整个思维体系、产品理念、技术架构的全面换代超越，而这是平庸的部门管理者所无法真正理解的，毕竟职场里面的利益斗争真的是处处可见，几乎没有人是首先想到的是如何把事情做好，反而是首先上来就考虑自己的眼前的短期利益，而冠冕堂皇地还会被封装在一个叫做“投入产出比” “提高执行效率”的套话里面。</p>
<p>但始终是没有人会真正地理解：眼前最优解并不是近期最优解，近期最优解并不是长期最优解。</p>
<p>看似选对了每一小步的最优解，但却离全局最优解越来越远。深度学习为了防止过度拟合都需要引入随机变量，而企业内部如果只为追求完美无暇和表面上的漂亮，最终将获得的是一潭死水。</p>
<p>理念和方向选错了，走的再快那又如何呢？</p>
<p>我又废话了，扯回来飞书消息通知，它发送消息的内容格式说明的文档在 <a href="https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/im-v1/message/create_json">https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/im-v1/message/create_json</a></p>
<p>第一眼看上去你以为跟钉钉和企业微信也没啥差别，不就是那么几种常见的消息格式么，但是如果仔细想，每个平台都有一种消息格式是比较特殊和复杂度较高显示效果漂亮的，其实飞书也不例外：消息卡片，可以从文档跳到这里地址：https://open.feishu.cn/document/ukTMukTMukTM/uczM3QjL3MzN04yNzcDN 就能看到这个极为复杂和效果丰富的消息卡片的说明了。</p>
<p>这次由于格式复杂，内容量很大，就不全量贴代码了（其实是没写完 ^-^ ）</p>
<p>先看几个简单的例子：</p>
<p>一开始的文本消息就有好几个例子，我们只先看一个。</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#a00;background-color:#faa">//</span> <span style="color:#a00;background-color:#faa">文本消息</span>
{
    <span style="color:#309;font-weight:bold">&#34;receive_id&#34;</span>: <span style="color:#c30">&#34;oc_xxx&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;content&#34;</span>: <span style="color:#c30">&#34;{\&#34;text\&#34;:\&#34;firstline \\n second line  \&#34;}&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;msg_type&#34;</span>: <span style="color:#c30">&#34;text&#34;</span>
}
</code></pre></div><div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#a00;background-color:#faa">//</span> <span style="color:#a00;background-color:#faa">图片消息</span>
{
	<span style="color:#309;font-weight:bold">&#34;receive_id&#34;</span>: <span style="color:#c30">&#34;oc_xxx&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;content&#34;</span>: <span style="color:#c30">&#34;{\&#34;image_key\&#34;: \&#34;img_v2_xxx\&#34;}&#34;</span>,
	<span style="color:#309;font-weight:bold">&#34;msg_type&#34;</span>: <span style="color:#c30">&#34;image&#34;</span>
}
</code></pre></div><div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#a00;background-color:#faa">//</span> <span style="color:#a00;background-color:#faa">富文本消息</span>
{
	<span style="color:#309;font-weight:bold">&#34;zh_cn&#34;</span>: {
		<span style="color:#309;font-weight:bold">&#34;title&#34;</span>: <span style="color:#c30">&#34;我是一个标题&#34;</span>,
		<span style="color:#309;font-weight:bold">&#34;content&#34;</span>: [
			[
				{
					<span style="color:#309;font-weight:bold">&#34;tag&#34;</span>: <span style="color:#c30">&#34;text&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;text&#34;</span>: <span style="color:#c30">&#34;第一行:&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;style&#34;</span>: [<span style="color:#c30">&#34;bold&#34;</span>, <span style="color:#c30">&#34;underline&#34;</span>]
                  
				},
				{
					<span style="color:#309;font-weight:bold">&#34;tag&#34;</span>: <span style="color:#c30">&#34;a&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;href&#34;</span>: <span style="color:#c30">&#34;http://www.feishu.cn&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;text&#34;</span>: <span style="color:#c30">&#34;超链接&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;style&#34;</span>: [<span style="color:#c30">&#34;bold&#34;</span>, <span style="color:#c30">&#34;italic&#34;</span>]
				},
				{
					<span style="color:#309;font-weight:bold">&#34;tag&#34;</span>: <span style="color:#c30">&#34;at&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;user_id&#34;</span>: <span style="color:#c30">&#34;ou_1avnmsbv3k45jnk34j5&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;user_name&#34;</span>: <span style="color:#c30">&#34;tom&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;style&#34;</span>: [<span style="color:#c30">&#34;lineThrough&#34;</span>]
				}
			],
			[{
				<span style="color:#309;font-weight:bold">&#34;tag&#34;</span>: <span style="color:#c30">&#34;img&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;image_key&#34;</span>: <span style="color:#c30">&#34;img_7ea74629-9191-4176-998c-2e603c9c5e8g&#34;</span>
			}],
			[	
				{
					<span style="color:#309;font-weight:bold">&#34;tag&#34;</span>: <span style="color:#c30">&#34;text&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;text&#34;</span>: <span style="color:#c30">&#34;第二行:&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;style&#34;</span>: [<span style="color:#c30">&#34;bold&#34;</span>, <span style="color:#c30">&#34;underline&#34;</span>]
				},
				{
					<span style="color:#309;font-weight:bold">&#34;tag&#34;</span>: <span style="color:#c30">&#34;text&#34;</span>,
					<span style="color:#309;font-weight:bold">&#34;text&#34;</span>: <span style="color:#c30">&#34;文本测试&#34;</span>
				}
			],
			[{
				<span style="color:#309;font-weight:bold">&#34;tag&#34;</span>: <span style="color:#c30">&#34;img&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;image_key&#34;</span>: <span style="color:#c30">&#34;img_7ea74629-9191-4176-998c-2e603c9c5e8g&#34;</span>
			}],
          	[{
				<span style="color:#309;font-weight:bold">&#34;tag&#34;</span>: <span style="color:#c30">&#34;media&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;file_key&#34;</span>: <span style="color:#c30">&#34;file_v2_0dcdd7d9-fib0-4432-a519-41d25aca542j&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;image_key&#34;</span>: <span style="color:#c30">&#34;img_7ea74629-9191-4176-998c-2e603c9c5e8g&#34;</span>
			}],
          	[{
				<span style="color:#309;font-weight:bold">&#34;tag&#34;</span>: <span style="color:#c30">&#34;emotion&#34;</span>,
				<span style="color:#309;font-weight:bold">&#34;emoji_type&#34;</span>: <span style="color:#c30">&#34;SMILE&#34;</span>
			}]
		]
	},
	<span style="color:#309;font-weight:bold">&#34;en_us&#34;</span>: {
		<span style="color:#a00;background-color:#faa">...</span>
	}
}
</code></pre></div><p>这也太突然了，富文本是什么东西，这结构就复杂非常多了。</p>
<p>然后它还有语音、视频、文件、表情包、个人名片、群名片，这些就不看了，我们看看还有最特殊的：消息卡片。</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#a00;background-color:#faa">//</span> <span style="color:#a00;background-color:#faa">消息卡片</span>
{
    <span style="color:#309;font-weight:bold">&#34;receive_id&#34;</span>: <span style="color:#c30">&#34;oc_820faa21d7ed275b53d1727a0feaa917&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;content&#34;</span>: <span style="color:#c30">&#34;{\&#34;config\&#34;:{\&#34;wide_screen_mode\&#34;:true},\&#34;elements\&#34;:[{\&#34;alt\&#34;:{\&#34;content\&#34;:\&#34;\&#34;,\&#34;tag\&#34;:\&#34;plain_text\&#34;},\&#34;img_key\&#34;:\&#34;img_7ea74629-9191-4176-998c-2e603c9c5e8g\&#34;,\&#34;tag\&#34;:\&#34;img\&#34;},{\&#34;tag\&#34;:\&#34;div\&#34;,\&#34;text\&#34;:{\&#34;content\&#34;:\&#34;你是否曾因为一本书而产生心灵共振，开始感悟人生？\\n你有哪些想极力推荐给他人的珍藏书单？\\n\\n加入 **4·23 飞书读书节**，分享你的**挚爱书单**及**读书笔记**，**赢取千元读书礼**！\\n\\n📬 填写问卷，晒出你的珍藏好书\\n😍 想知道其他人都推荐了哪些好书？马上[入群围观](https://open.feishu.cn/)\\n📝 用[读书笔记模板](https://open.feishu.cn/)（桌面端打开），记录你的心得体会\\n🙌 更有惊喜特邀嘉宾 4月12日起带你共读\&#34;,\&#34;tag\&#34;:\&#34;lark_md\&#34;}},{\&#34;actions\&#34;:[{\&#34;tag\&#34;:\&#34;button\&#34;,\&#34;text\&#34;:{\&#34;content\&#34;:\&#34;立即推荐好书\&#34;,\&#34;tag\&#34;:\&#34;plain_text\&#34;},\&#34;type\&#34;:\&#34;primary\&#34;,\&#34;url\&#34;:\&#34;https://open.feishu.cn/\&#34;},{\&#34;tag\&#34;:\&#34;button\&#34;,\&#34;text\&#34;:{\&#34;content\&#34;:\&#34;查看活动指南\&#34;,\&#34;tag\&#34;:\&#34;plain_text\&#34;},\&#34;type\&#34;:\&#34;default\&#34;,\&#34;url\&#34;:\&#34;https://open.feishu.cn/\&#34;}],\&#34;tag\&#34;:\&#34;action\&#34;}],\&#34;header\&#34;:{\&#34;template\&#34;:\&#34;turquoise\&#34;,\&#34;title\&#34;:{\&#34;content\&#34;:\&#34;📚晒挚爱好书，赢读书礼金\&#34;,\&#34;tag\&#34;:\&#34;plain_text\&#34;}}}&#34;</span>,
    <span style="color:#309;font-weight:bold">&#34;msg_type&#34;</span>: <span style="color:#c30">&#34;interactive&#34;</span>
}
</code></pre></div><p>呃这里面中间一坨大 json 序列化过后得到的字符串，我们看看它原来的样子，把 content 取出来单独看。</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#309;font-weight:bold">&#34;config&#34;</span>:{
        <span style="color:#309;font-weight:bold">&#34;wide_screen_mode&#34;</span>:<span style="color:#069;font-weight:bold">true</span>
    },
    <span style="color:#309;font-weight:bold">&#34;elements&#34;</span>:[
        {
            <span style="color:#309;font-weight:bold">&#34;alt&#34;</span>:{
                <span style="color:#309;font-weight:bold">&#34;content&#34;</span>:<span style="color:#c30">&#34;&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;tag&#34;</span>:<span style="color:#c30">&#34;plain_text&#34;</span>
            },
            <span style="color:#309;font-weight:bold">&#34;img_key&#34;</span>:<span style="color:#c30">&#34;img_7ea74629-9191-4176-998c-2e603c9c5e8g&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;tag&#34;</span>:<span style="color:#c30">&#34;img&#34;</span>
        },
        {
            <span style="color:#309;font-weight:bold">&#34;tag&#34;</span>:<span style="color:#c30">&#34;div&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;text&#34;</span>:{
                <span style="color:#309;font-weight:bold">&#34;content&#34;</span>:<span style="color:#c30">&#34;你是否曾因为一本书而产生心灵共振，开始感悟人生？
</span><span style="color:#c30">你有哪些想极力推荐给他人的珍藏书单？
</span><span style="color:#c30">
</span><span style="color:#c30">加入 **4·23 飞书读书节**，分享你的**挚爱书单**及**读书笔记**，**赢取千元读书礼**！
</span><span style="color:#c30">
</span><span style="color:#c30">📬 填写问卷，晒出你的珍藏好书
</span><span style="color:#c30">😍 想知道其他人都推荐了哪些好书？马上[入群围观](https://open.feishu.cn/)
</span><span style="color:#c30">📝 用[读书笔记模板](https://open.feishu.cn/)（桌面端打开），记录你的心得体会
</span><span style="color:#c30">🙌 更有惊喜特邀嘉宾 4月12日起带你共读&#34;</span>,
                <span style="color:#309;font-weight:bold">&#34;tag&#34;</span>:<span style="color:#c30">&#34;lark_md&#34;</span>
            }
        },
        {
            <span style="color:#309;font-weight:bold">&#34;actions&#34;</span>:[
                {
                    <span style="color:#309;font-weight:bold">&#34;tag&#34;</span>:<span style="color:#c30">&#34;button&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;text&#34;</span>:{
                        <span style="color:#309;font-weight:bold">&#34;content&#34;</span>:<span style="color:#c30">&#34;立即推荐好书&#34;</span>,
                        <span style="color:#309;font-weight:bold">&#34;tag&#34;</span>:<span style="color:#c30">&#34;plain_text&#34;</span>
                    },
                    <span style="color:#309;font-weight:bold">&#34;type&#34;</span>:<span style="color:#c30">&#34;primary&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;url&#34;</span>:<span style="color:#c30">&#34;https://open.feishu.cn/&#34;</span>
                },
                {
                    <span style="color:#309;font-weight:bold">&#34;tag&#34;</span>:<span style="color:#c30">&#34;button&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;text&#34;</span>:{
                        <span style="color:#309;font-weight:bold">&#34;content&#34;</span>:<span style="color:#c30">&#34;查看活动指南&#34;</span>,
                        <span style="color:#309;font-weight:bold">&#34;tag&#34;</span>:<span style="color:#c30">&#34;plain_text&#34;</span>
                    },
                    <span style="color:#309;font-weight:bold">&#34;type&#34;</span>:<span style="color:#c30">&#34;default&#34;</span>,
                    <span style="color:#309;font-weight:bold">&#34;url&#34;</span>:<span style="color:#c30">&#34;https://open.feishu.cn/&#34;</span>
                }
            ],
            <span style="color:#309;font-weight:bold">&#34;tag&#34;</span>:<span style="color:#c30">&#34;action&#34;</span>
        }
    ],
    <span style="color:#309;font-weight:bold">&#34;header&#34;</span>:{
        <span style="color:#309;font-weight:bold">&#34;template&#34;</span>:<span style="color:#c30">&#34;turquoise&#34;</span>,
        <span style="color:#309;font-weight:bold">&#34;title&#34;</span>:{
            <span style="color:#309;font-weight:bold">&#34;content&#34;</span>:<span style="color:#c30">&#34;📚晒挚爱好书，赢读书礼金&#34;</span>,
            <span style="color:#309;font-weight:bold">&#34;tag&#34;</span>:<span style="color:#c30">&#34;plain_text&#34;</span>
        }
    }
}
</code></pre></div><p>是不是觉得已经要放弃了？根据我自己的经历，没有人会想要真正去研究它到底有哪些组件，以及它们又是如何实现组合回来的。</p>
<p>我们先从外层干起。</p>
<p><code>model/msg/feishu/mod.rs</code></p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">mod</span> <span style="color:#0cf;font-weight:bold">interactive</span>;<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">mod</span> <span style="color:#0cf;font-weight:bold">applink</span>;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::{FeishuInteractiveMsg,<span style="color:#bbb"> </span>Language};<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 飞书消息类型
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema, Ord, PartialOrd, Eq, PartialEq, Hash)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">FeishuMsgType</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 文本
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;text&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Text,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 富文本
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;post&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Post,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 图片
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;image&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Image,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 消息卡片
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;interactive&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Interactive,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 分享群名片
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;share_chat&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>ShareChat,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 分享个人名片
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;share_user&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>ShareUser,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 语音
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;audio&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Audio,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 视频
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;media&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Media,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 文件
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;file&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>File,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 表情包
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;sticker&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Sticker,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 飞书消息提交参数，把消息序列化后再用它解析出来，内层的消息体就是字符串
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuMsgReq</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>msg_type: <span style="color:#0a8;font-weight:bold">FeishuMsgType</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>content: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 飞书消息 @ At
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuMsgAt</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>user_id: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>user_name: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>is_to_all: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">bool</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">impl</span><span style="color:#bbb"> </span>Display<span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">for</span><span style="color:#bbb"> </span>FeishuMsgAt<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">fn</span> <span style="color:#c0f">fmt</span>(<span style="color:#555">&amp;</span>self,<span style="color:#bbb"> </span>f: <span style="color:#069">&amp;</span><span style="color:#0a8;font-weight:bold">mut</span><span style="color:#bbb"> </span>Formatter<span style="color:#555">&lt;</span><span style="color:#309">&#39;_</span><span style="color:#555">&gt;</span>)<span style="color:#bbb"> </span>-&gt; <span style="color:#0a8;font-weight:bold">std</span>::fmt::<span style="color:#366">Result</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#069;font-weight:bold">if</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">let</span><span style="color:#bbb"> </span><span style="color:#366">Some</span>(is_to_all)<span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span>self.is_to_all<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#069;font-weight:bold">if</span><span style="color:#bbb"> </span>is_to_all<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#069;font-weight:bold">return</span><span style="color:#bbb"> </span>f.write_str(format<span style="color:#555">!</span>(<span style="color:#c30">&#34;&lt;at user_id=\&#34;all\&#34;&gt;所有人&lt;/at&gt;&#34;</span>).as_str());<span style="color:#bbb">
</span><span style="color:#bbb">            </span>}<span style="color:#bbb">
</span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#069;font-weight:bold">if</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">let</span><span style="color:#bbb"> </span><span style="color:#366">Some</span>(user_id)<span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span><span style="color:#555">&amp;</span>self.user_id<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">            </span><span style="color:#069;font-weight:bold">if</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">let</span><span style="color:#bbb"> </span><span style="color:#366">Some</span>(user_name)<span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span><span style="color:#555">&amp;</span>self.user_name<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">                </span><span style="color:#069;font-weight:bold">return</span><span style="color:#bbb"> </span>f.write_str(format<span style="color:#555">!</span>(<span style="color:#c30">&#34;&lt;at user_id=\&#34;{}\&#34;&gt;{}&lt;/at&gt;&#34;</span>,<span style="color:#bbb"> </span>user_id,<span style="color:#bbb"> </span>user_name).as_str());<span style="color:#bbb">
</span><span style="color:#bbb">            </span>}<span style="color:#bbb">
</span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span><span style="color:#bbb">        </span>error<span style="color:#555">!</span>(<span style="color:#c30">&#34;参数错误：user_id, user_name / is_to_all 不能同时为 None&#34;</span>);<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#366">Err</span>(std::fmt::Error)<span style="color:#bbb">
</span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 飞书消息
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#099">#[serde(tag = </span><span style="color:#c30">&#34;msg_type&#34;</span><span style="color:#099">, content = </span><span style="color:#c30">&#34;content&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">FeishuMsg</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 文本
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;text&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Text(FeishuTextMsg),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 富文本
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;post&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Post(FeishuPostMsg),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 图片
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;image&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Image(FeishuImageMsg),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 消息卡片
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;interactive&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Interactive(FeishuInteractiveMsg),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 分享群名片
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;share_chat&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>ShareChat(FeishuShareChatMsg),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 分享个人名片
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;share_user&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>ShareUser(FeishuShareUserMsg),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 语音
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;audio&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Audio(FeishuAudioMsg),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 视频
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;media&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Media(FeishuMediaMsg),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 文件
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;file&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>File(FeishuFileMsg),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 表情包
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;sticker&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Sticker(FeishuStickerMsg),<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 文本
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuTextMsg</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>text: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 富文本
</span><span style="color:#c30;font-style:italic"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">type</span> <span style="color:#0a8;font-weight:bold">FeishuPostMsg</span><span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span>HashMap<span style="color:#555">&lt;</span>Language,<span style="color:#bbb"> </span>FeishuPostMsgBody<span style="color:#555">&gt;</span>;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 富文本 消息体
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuPostMsgBody</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>title: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>content: <span style="color:#366">Vec</span><span style="color:#555">&lt;</span>FeishuPostMsgBodyParagraph<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 富文本 消息体 段落
</span><span style="color:#c30;font-style:italic"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">type</span> <span style="color:#0a8;font-weight:bold">FeishuPostMsgBodyParagraph</span><span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span><span style="color:#366">Vec</span><span style="color:#555">&lt;</span>FeishuPostMsgBodyParagraphItem<span style="color:#555">&gt;</span>;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 富文本 消息体 段落 Item
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#099">#[serde(tag = </span><span style="color:#c30">&#34;tag&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">FeishuPostMsgBodyParagraphItem</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;text&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Text(FeishuPostMsgBodyParagraphItemText),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;a&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>A(FeishuPostMsgBodyParagraphItemA),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;at&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>At(FeishuPostMsgBodyParagraphItemAt),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;img&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Img(FeishuPostMsgBodyParagraphItemImg),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;media&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Media(FeishuPostMsgBodyParagraphItemMedia),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;emotion&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Emotion(FeishuPostMsgBodyParagraphItemEmotion),<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 富文本 消息体 段落 Item text
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuPostMsgBodyParagraphItemText</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>text: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>un_escape: <span style="color:#078;font-weight:bold">bool</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 富文本 消息体 段落 Item a
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuPostMsgBodyParagraphItemA</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>text: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>href: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 富文本 消息体 段落 Item at
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuPostMsgBodyParagraphItemAt</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>user_id: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>user_name: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 富文本 消息体 段落 Item img
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuPostMsgBodyParagraphItemImg</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>image_key: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 富文本 消息体 段落 Item media
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuPostMsgBodyParagraphItemMedia</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>file_key: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>image_key: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 富文本 消息体 段落 Item emotion
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuPostMsgBodyParagraphItemEmotion</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>emoji_type: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 图片
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuImageMsg</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>image_key: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 分享群名片
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuShareChatMsg</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>chat_id: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 分享个人名片
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuShareUserMsg</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>user_id: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 语音
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuAudioMsg</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>file_key: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 视频
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuMediaMsg</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>file_key: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>image_key: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 文件
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuFileMsg</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>file_key: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 表情包
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuStickerMsg</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>file_key: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><p>会发现这次的结构稍微又有些不一样了，由于最终提交接口的数据中 content 是序列化后的结果，所以得为它单独声明一个统一的结构。</p>
<p>而消息本身的结构，则是同样也是通过枚举的方式进行综合声明，而这次我们用到了 <code>#[serde(tag = &quot;msg_type&quot;, content = &quot;content&quot;)]</code> 这样的形式，这样使得在既能明确声明所有支持的消息格式，限定了格式范围之外，还让 <code>msg_type</code> 和 <code>content</code> 这两个平级的字段也很好地被支持了。而如果是一开始在某些强类型语言中，可能真的就会把 <code>msg_type</code> 声明为简单枚举，然后把 <code>content</code> 声明为泛型了，或者在 Golang 早起版本里面就只能声明为 <code>interface {}</code> 了，而近期版本也仅仅只是换了个名字叫 <code>any</code> 而已，本质上并没有什么区别。</p>
<p>至于 Python 就是反正什么类型都可以，所以这事情在它这里可能还是最简单不过的了，但也仅限一些简单处理，如果想要对这消息本身要做些什么复杂处理，就稍显乏力了。</p>
<p>外层的看完了，此时该看看“消息卡片”了，这次同样也把它放到了一个子模块里面，但是这个子模块里面又有更多的子模块，层层分解，非常符合人类的常规思维。</p>
<p><code>model/msg/feishu/interactive/mod.rs</code></p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::content::{Element,<span style="color:#bbb"> </span>I18nElements};<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::content::config::Config;<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::content::header::Header;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">mod</span> <span style="color:#0cf;font-weight:bold">content</span>;<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">mod</span> <span style="color:#0cf;font-weight:bold">action</span>;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">FeishuInteractiveMsg</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 用于描述卡片的功能属性。
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(skip_serializing_if = </span><span style="color:#c30">&#34;Option::is_none&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>config: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>Config<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 用于配置卡片标题内容。
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(skip_serializing_if = </span><span style="color:#c30">&#34;Option::is_none&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>header: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>Header<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 用于定义卡片正文内容，和i18n_elements至少必填其中1个
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(skip_serializing_if = </span><span style="color:#c30">&#34;Option::is_none&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>elements: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">Vec</span><span style="color:#555">&lt;</span>Element<span style="color:#555">&gt;&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 为卡片的正文部分定义多语言内容，和elements至少必填其中1个
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(skip_serializing_if = </span><span style="color:#c30">&#34;Option::is_none&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>i18n_elements: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>I18nElements<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 语言代码
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema, Ord, PartialOrd, Eq, PartialEq, Hash)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">Language</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;zh_cn&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>ZhCn,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;en_us&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>EnUs,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><p>而在整个消息卡片体系下，又分为<code>内容 content </code> 和 <code>动作 action</code> ，我们先来看动作的部分，谁让它字母排序靠前呢。</p>
<p><code>model/msg/feishu/interactive/action/mod.rs</code></p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::action::module::ActionModule;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">mod</span> <span style="color:#0cf;font-weight:bold">module</span>;<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">mod</span> <span style="color:#0cf;font-weight:bold">element</span>;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 交互
</span><span style="color:#c30;font-style:italic">/// https://open.feishu.cn/document/ukTMukTMukTM/uYjNwUjL2YDM14iN2ATN
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">Action</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>tag: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>actions: <span style="color:#366">Vec</span><span style="color:#555">&lt;</span>ActionModule<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>layout: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>ActionLayout<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 交互元素布局，窄版样式默认纵向排列
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">ActionLayout</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;bisected&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Bisected,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;trisection&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Trisection,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;flow&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Flow,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><p><code>model/msg/feishu/interactive/action/element.rs</code></p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::content::element::Text;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 可内嵌的交互元素 card_link
</span><span style="color:#c30;font-style:italic">/// https://open.feishu.cn/document/ukTMukTMukTM/uYDN1UjL2QTN14iN0UTN
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">ActionCardLink</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 默认的链接地址
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>url: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// PC 端的链接地址
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>pc_url: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// iOS 端的链接地址
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>ios_url: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// Android 端的链接地址
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>android_url: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 可内嵌的交互元素 confirm
</span><span style="color:#c30;font-style:italic">/// https://open.feishu.cn/document/ukTMukTMukTM/ukzNwUjL5cDM14SO3ATN
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">ActionConfirm</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 弹框标题
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>title: <span style="color:#0a8;font-weight:bold">Text</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 弹框内容
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>text: <span style="color:#0a8;font-weight:bold">Text</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 可内嵌的交互元素 option
</span><span style="color:#c30;font-style:italic">/// https://open.feishu.cn/document/ukTMukTMukTM/ugzNwUjL4cDM14CO3ATN
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">ActionOption</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 选项显示内容，非待选人员时必填
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>text: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>Text<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 选项选中后返回业务方的数据，与url或multi_url必填其中一个
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>value: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// *仅支持overflow，跳转指定链接，和multi_url字段互斥
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>url: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// *仅支持overflow，跳转对应链接，和url字段互斥
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>multi_url: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>ActionUrl<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 可内嵌的交互元素
</span><span style="color:#c30;font-style:italic">/// https://open.feishu.cn/document/ukTMukTMukTM/uczNwUjL3cDM14yN3ATN
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">ActionUrl</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 默认跳转链接，参考注意事项-2
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>url: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 安卓端跳转链接
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>android_url: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// ios端跳转链接
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>ios_url: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// pc端跳转链接
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>pc_url: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span></code></pre></div><p><code>model/msg/feishu/interactive/action/module.rs</code></p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::action::element::{ActionConfirm,<span style="color:#bbb"> </span>ActionOption,<span style="color:#bbb"> </span>ActionUrl};<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::content::element::Text;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 交互模块
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#099">#[serde(tag = </span><span style="color:#c30">&#34;tag&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">ActionModule</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;button&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Button(Button),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;select_static&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>SelectStatic(SelectMenu),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;select_person&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>SelectPerson(SelectMenu),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;overflow&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>OverFlow(OverFlow),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;date_picker&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>DatePicker(DatePicker),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;picker_time&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>PickerTime(DatePicker),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;picker_datetime&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>PickerDatetime(DatePicker),<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 交互组件 datePicker
</span><span style="color:#c30;font-style:italic">/// https://open.feishu.cn/document/ukTMukTMukTM/uQzNwUjL0cDM14CN3ATN
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">DatePicker</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>initial_date: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>initial_time: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>initial_datetime: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>placeholder: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>Text<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>value: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>HashMap<span style="color:#555">&lt;</span><span style="color:#366">String</span>,<span style="color:#bbb"> </span>Value<span style="color:#555">&gt;&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>confirm: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>ActionConfirm<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 交互组件 overflow
</span><span style="color:#c30;font-style:italic">/// https://open.feishu.cn/document/ukTMukTMukTM/uMzNwUjLzcDM14yM3ATN
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">OverFlow</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>options: <span style="color:#366">Vec</span><span style="color:#555">&lt;</span>ActionOption<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>value: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>HashMap<span style="color:#555">&lt;</span><span style="color:#366">String</span>,<span style="color:#bbb"> </span>Value<span style="color:#555">&gt;&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>confirm: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>ActionConfirm<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 交互组件 selectMenu
</span><span style="color:#c30;font-style:italic">/// https://open.feishu.cn/document/ukTMukTMukTM/uIzNwUjLycDM14iM3ATN
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">SelectMenu</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>placeholder: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>Text<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>initial_option: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>options: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">Vec</span><span style="color:#555">&lt;</span>ActionOption<span style="color:#555">&gt;&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>value: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>HashMap<span style="color:#555">&lt;</span><span style="color:#366">String</span>,<span style="color:#bbb"> </span>Value<span style="color:#555">&gt;&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>confirm: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>ActionConfirm<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 交互组件 button
</span><span style="color:#c30;font-style:italic">/// https://open.feishu.cn/document/ukTMukTMukTM/uEzNwUjLxcDM14SM3ATN
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">Button</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>text: <span style="color:#0a8;font-weight:bold">Text</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>url: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>multi_url: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>ActionUrl<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;type&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>type_: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>ButtonType<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>value: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>HashMap<span style="color:#555">&lt;</span><span style="color:#366">String</span>,<span style="color:#bbb"> </span>Value<span style="color:#555">&gt;&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>confirm: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>ActionConfirm<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 交互组件 button type
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">ButtonType</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;default&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#366">Default</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;primary&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Primary,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;danger&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Danger,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><p>这次上面这里面除了用到了常规的数据结构之外，还用到了 <code>serde_json::Value</code> 这个可以包罗万象的不定格式结构，而它正是描述整个 json 数据结构体系的综合性结构声明，而它也正是一个枚举。</p>
<p><code>model/msg/feishu/interactive/content/mod.rs</code></p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::content::module::ContentModule;<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::Language;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">mod</span> <span style="color:#0cf;font-weight:bold">element</span>;<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">mod</span> <span style="color:#0cf;font-weight:bold">module</span>;<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">mod</span> <span style="color:#0cf;font-weight:bold">header</span>;<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">mod</span> <span style="color:#0cf;font-weight:bold">layout</span>;<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">mod</span> <span style="color:#0cf;font-weight:bold">config</span>;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 正文内容
</span><span style="color:#c30;font-style:italic"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">type</span> <span style="color:#0a8;font-weight:bold">Element</span><span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span>ContentModule;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 多语言正文内容
</span><span style="color:#c30;font-style:italic"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">type</span> <span style="color:#0a8;font-weight:bold">I18nElements</span><span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span>HashMap<span style="color:#555">&lt;</span>Language,<span style="color:#bbb"> </span>ContentModule<span style="color:#555">&gt;</span>;<span style="color:#bbb">
</span></code></pre></div><p>能看到内容下面又细分了 元素 element、模块 module、头部 header、布局 layout、配置 config 这五个部分，妥妥滴定义了一套几乎全新的类 HTML 呀。</p>
<p><code>model/msg/feishu/interactive/content/config.rs</code></p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#c30;font-style:italic">/// 消息卡片 功能属性
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">Config</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 是否允许卡片被转发。
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>enable_forward: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">bool</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 是否为共享卡片。
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>update_multi: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">bool</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><p><code>model/msg/feishu/interactive/content/element.rs</code></p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::action::module::ActionModule;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 可内嵌的非交互元素 field
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">Field</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>is_short: <span style="color:#078;font-weight:bold">bool</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>text: <span style="color:#0a8;font-weight:bold">Text</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 可内嵌的非交互元素 text
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#099">#[serde(tag = </span><span style="color:#c30">&#34;tag&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">Text</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;plain_text&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>PlainText(TextContent),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;lark_md&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>LarkMd(TextContent),<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">TextContent</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>content: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>lines: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">u32</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 可内嵌的非交互元素 image
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#099">#[serde(tag = </span><span style="color:#c30">&#34;tag&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">Image</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;img&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Img(ImageContent),<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">ImageContent</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>img_key: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>alt: <span style="color:#0a8;font-weight:bold">Text</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>preview: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">bool</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#099">#[serde(untagged)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">Extra</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span>Image(Image),<span style="color:#bbb">
</span><span style="color:#bbb">    </span>ActionModule(ActionModule),<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><p><code>model/msg/feishu/interactive/content/header.rs</code></p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::content::element::Text;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 卡片标题
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">Header</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 配置卡片标题内容 text 对象（仅支持&#34;plain_text&#34;)
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>title: <span style="color:#0a8;font-weight:bold">HeaderTitle</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 控制标题背景颜色，取值参考注意事项
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(skip_serializing_if = </span><span style="color:#c30">&#34;Option::is_none&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>template: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>HeaderTemplate<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">type</span> <span style="color:#0a8;font-weight:bold">HeaderTitle</span><span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span>Text;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 卡片标题 卡片标题的主题色
</span><span style="color:#c30;font-style:italic">///
</span><span style="color:#c30;font-style:italic">/// 最佳实践
</span><span style="color:#c30;font-style:italic">/// 彩色标题适合在群聊中使用，对于需高亮提醒的卡片信息，可将标题配置为应用的品牌色或表达状态的语义色，增强信息的视觉锚点。
</span><span style="color:#c30;font-style:italic">/// 在单聊中，建议根据卡片的状态不同，配置不同的语义颜色标题
</span><span style="color:#c30;font-style:italic">/// 绿色（Green）代表完成/成功
</span><span style="color:#c30;font-style:italic">/// 橙色（Orange）代表警告/警示
</span><span style="color:#c30;font-style:italic">/// 红色（Red）代表错误/异常
</span><span style="color:#c30;font-style:italic">/// 灰色（Grey）代表失效
</span><span style="color:#c30;font-style:italic">/// 不建议在单聊中，每张卡片无差别地使用同一种颜色的标题。这样既无法起到强调作用，也可能引起阅读者的视觉焦虑。
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">HeaderTemplate</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;blue&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Blue,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;wathet&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Wathet,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;turquoise&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Turquoise,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;green&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Green,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;yellow&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Yellow,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;orange&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Orange,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;red&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Red,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;carmine&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Carmine,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;violet&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Violet,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;purple&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Purple,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;indigo&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Indigo,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;grey&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Grey,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><p><code>model/msg/feishu/interactive/content/layout.rs</code></p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::action::element::ActionUrl;<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::content::module::ContentModule;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 布局 多列布局
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">ColumnSet</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>tag: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>columns: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">Vec</span><span style="color:#555">&lt;</span>Column<span style="color:#555">&gt;&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>flex_mode: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>background_style: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>horizontal_spacing: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 设置点击布局容器时，响应的交互配置。当前仅支持跳转交互。如果布局容器内有交互组件，则优先响应交互组件定义的交互。
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>action: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>ColumnSetAction<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 布局 列
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">Column</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>tag: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>elements: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>ColumnElements<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>width: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>weight: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">u8</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>vertical_align: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>ColumnVerticalAlign<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 布局 列 卡片元素
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">ColumnElements</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span>Elements(<span style="color:#366">Vec</span><span style="color:#555">&lt;</span>ContentModule<span style="color:#555">&gt;</span>),<span style="color:#bbb">
</span><span style="color:#bbb">    </span>ColumnSet(<span style="color:#366">Vec</span><span style="color:#555">&lt;</span>ColumnSet<span style="color:#555">&gt;</span>),<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 布局 多列布局 交互配置
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">ColumnSetAction</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>multi_url: <span style="color:#0a8;font-weight:bold">ActionUrl</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 布局 列 垂直对齐
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">ColumnVerticalAlign</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;top&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Top,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;center&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Center,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;bottom&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Bottom,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span></code></pre></div><p><code>model/msg/feishu/interactive/content/module.rs</code></p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::action::element::ActionUrl;<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">use</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">crate</span>::model::msg::feishu::interactive::content::element::{Extra,<span style="color:#bbb"> </span>Field,<span style="color:#bbb"> </span>Image,<span style="color:#bbb"> </span>Text};<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 正文内容
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#099">#[serde(tag = </span><span style="color:#c30">&#34;tag&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">ContentModule</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;div&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Div(Div),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;markdown&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Markdown(Markdown),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;hr&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Hr(Hr),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;img&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Img(Img),<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;note&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Note(Note),<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 内容模块
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">Div</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>text: <span style="color:#0a8;font-weight:bold">Text</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>fields: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">Vec</span><span style="color:#555">&lt;</span>Field<span style="color:#555">&gt;&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>extra: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>Extra<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 Markdown模块
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">Markdown</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>content: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>text_align: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>TextAlign<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>href: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>Href<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 Markdown模块 text_align
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">TextAlign</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span>Left,<span style="color:#bbb">
</span><span style="color:#bbb">    </span>Center,<span style="color:#bbb">
</span><span style="color:#bbb">    </span>Right,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 Markdown模块 href
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">Href</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;urlVal&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>url_val: <span style="color:#0a8;font-weight:bold">ActionUrl</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 分割线模块
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">Hr</span><span style="color:#bbb"> </span>{}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 图片模块
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">Img</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>img_key: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>alt: <span style="color:#0a8;font-weight:bold">Text</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>title: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>Text<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>custom_width: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">u16</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>compact_width: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">bool</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>mode: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>ImgMode<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>preview: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">bool</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 图片模块 mode
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">ImgMode</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;fit_horizontal&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>FitHorizontal,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;crop_center&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>CropCenter,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 分割线模块
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">Note</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>elements: <span style="color:#0a8;font-weight:bold">NoteElements</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 消息卡片 备注模块
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">NoteElements</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span>Text(<span style="color:#366">Vec</span><span style="color:#555">&lt;</span>Text<span style="color:#555">&gt;</span>),<span style="color:#bbb">
</span><span style="color:#bbb">    </span>Image(<span style="color:#366">Vec</span><span style="color:#555">&lt;</span>Image<span style="color:#555">&gt;</span>),<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span></code></pre></div><p>最后，还要额外附赠一个：AppLink 协议 <a href="https://open.feishu.cn/document/uYjL24iN/ucjN1UjL3YTN14yN2UTN">https://open.feishu.cn/document/uYjL24iN/ucjN1UjL3YTN14yN2UTN</a></p>
<p>在所有平台的消息体系中，链接是必不可少的，而链接虽然最终都是一串字符串，但是它却不是简单的一串字符串，而是一个协议的定义和封装，最后交付时才呈现为一个文本字符串。</p>
<p><code>model/msg/feishu/applink.rs</code></p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// AppLink 协议 就是一个 URL 协议。AppLink 协议可以用于打开飞书或者其中的一个功能。
</span><span style="color:#c30;font-style:italic">/// https://open.feishu.cn/document/uYjL24iN/ucjN1UjL3YTN14yN2UTN
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">AppLink</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>scheme: <span style="color:#0a8;font-weight:bold">Scheme</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>host: <span style="color:#0a8;font-weight:bold">Host</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>path: <span style="color:#0a8;font-weight:bold">Path</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>query: <span style="color:#0a8;font-weight:bold">HashMap</span><span style="color:#555">&lt;</span><span style="color:#366">String</span>,<span style="color:#bbb"> </span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">impl</span><span style="color:#bbb"> </span>Display<span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">for</span><span style="color:#bbb"> </span>AppLink<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">fn</span> <span style="color:#c0f">fmt</span>(<span style="color:#555">&amp;</span>self,<span style="color:#bbb"> </span>f: <span style="color:#069">&amp;</span><span style="color:#0a8;font-weight:bold">mut</span><span style="color:#bbb"> </span>Formatter<span style="color:#555">&lt;</span><span style="color:#309">&#39;_</span><span style="color:#555">&gt;</span>)<span style="color:#bbb"> </span>-&gt; <span style="color:#0a8;font-weight:bold">std</span>::fmt::<span style="color:#366">Result</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#069;font-weight:bold">let</span><span style="color:#bbb"> </span>scheme<span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span><span style="color:#555">&amp;</span>self.scheme;<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#069;font-weight:bold">let</span><span style="color:#bbb"> </span>host<span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span><span style="color:#555">&amp;</span>self.host;<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#069;font-weight:bold">let</span><span style="color:#bbb"> </span>path<span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span><span style="color:#555">&amp;</span>self.path;<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#069;font-weight:bold">let</span><span style="color:#bbb"> </span>query<span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span><span style="color:#555">&amp;</span>self.query;<span style="color:#bbb">
</span><span style="color:#bbb">        </span>todo<span style="color:#555">!</span>();<span style="color:#bbb">
</span><span style="color:#bbb">        </span>f.write_str(format<span style="color:#555">!</span>(<span style="color:#c30">&#34;{:?}://{:?}{:?}?{:?}&#34;</span>,<span style="color:#bbb"> </span>scheme,<span style="color:#bbb"> </span>host,<span style="color:#bbb"> </span>path,<span style="color:#bbb"> </span>query).as_str())<span style="color:#bbb">
</span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 协议
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">Scheme</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;https&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Https<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 域名
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">Host</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;applink.feishu.cn&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>AppLinkFeishuCn,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 路径，不同路径打开不同功能
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">Path</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开飞书
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/op/open&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Feishu,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开扫一扫
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/qrcode/main&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>QrCode,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开小程序
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/mini_program/open&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>MiniProgram,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开网页应用
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/web_app/open&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>WebApp,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开聊天页面
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/chat/open&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Chat,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开日历
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/calendar/open&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Calendar,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开日历（支持定义视图和日期）
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/calendar/view&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>CalendarView,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开日程创建页
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/calendar/event/create&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>CalendarEventCreate,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开第三方日历账户管理页
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/calendar/account&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>CalendarAccount,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开任务
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/todo/open&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Todo,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 创建任务
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/todo/create&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>TodoCreate,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开任务详情页
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/todo/detail&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>TodoDetail,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开任务Tab页
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/todo/view&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>TodoView,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开云文档
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/docs/open&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Docs,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开机器人会话
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/bot/open&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Bot,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开SSO登录页
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/passport/sso_login&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>PassportSsoLogin,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开PC端内web-view访问指定URL
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;/client/web_url/open&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>WebUrl,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 打开小程序 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">QueryMiniProgram</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 小程序 appId(可从「开发者后台-凭证与基础信息」获取)
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;appId&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>app_id: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// PC小程序启动模式 PC 建议填写
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>mode: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>QueryMiniProgramMode<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 自定义独立窗口高度（仅当mode为window时生效）
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>height: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">u32</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 自定义独立窗口宽度（仅当mode为window时生效）
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>width: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">u32</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 是否重新加载指定页面。该参数仅当applink中传入path参数时才会生效
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>relaunch: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">bool</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 需要跳转的页面路径，路径后可以带参数。也可以使用 path_android、path_ios、path_pc 参数对不同的客户端指定不同的path
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>path: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>MiniProgramPath<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 同 path 参数，Android 端会优先使用该参数，如果该参数不存在，则会使用 path 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>path_android: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>MiniProgramPath<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 同 path 参数，iOS 端会优先使用该参数，如果该参数不存在，则会使用 path 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>path_ios: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>MiniProgramPath<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 同 path 参数，PC 端会优先使用该参数，如果该参数不存在，则会使用 path 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>path_pc: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>MiniProgramPath<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 指定 AppLink 协议能够兼容的最小飞书版本，使用三位版本号 x.y.z。如果当前飞书版本号小于min_lk_ver，打开该 AppLink 会显示为兼容页面
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>min_lk_ver: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">type</span> <span style="color:#0a8;font-weight:bold">MiniProgramPath</span><span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span><span style="color:#366">String</span>;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// PC小程序启动模式
</span><span style="color:#c30;font-style:italic">/// 未填写的情况下，默认会优先使用sidebar-semi打开，不支持sidebar-semi模式的情况下会使用window-semi模式打开
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">QueryMiniProgramMode</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 聊天的侧边栏打开
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;sidebar-semi&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>SidebarSemi,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 工作台中打开
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;appCenter&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>AppCenter,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 独立大窗口打开
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;window&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Window,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 独立小窗口打开，飞书3.33版本开始支持此模式
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;window-semi&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>WindowSemi,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 打开网页应用 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">QueryWebApp</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// H5应用的 appId(可从「开发者后台-凭证与基础信息」获取)
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;appId&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>app_id: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 打开H5应用的容器模式
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>mode: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>QueryWebAppMode<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 自定义独立窗口高度（仅当mode为window时生效）
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>height: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">u32</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 自定义独立窗口宽度（仅当mode为window时生效）
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>width: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">u32</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 访问H5应用的具体某个页面，path参数将替换H5应用URL的path部分。如果需要携带参数，将预期的H5应用URL的query作为applink的query即可，
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>path: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>WebAppPath<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 同 path 参数，Android 端会优先使用该参数，如果该参数不存在，则会使用 path 参数。
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>path_android: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>WebAppPath<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 同 path 参数，iOS 端会优先使用该参数，如果该参数不存在，则会使用 path 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>path_ios: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>WebAppPath<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 同 path 参数，PC 端会优先使用该参数，如果该参数不存在，则会使用 path 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>path_pc: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>WebAppPath<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 访问H5应用的具体某个页面，针对网页path中包含#或?字符时，可使用该参数，而不使用path参数。需要填写H5应用某个具体页面的完整URL（协议名scheme和域名domain应当与开发者后台配置的应用首页相匹配），并进行URL encode后使用
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>lk_target_url: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 如果网页应用当前所处的页面路径和 applink 要打开的页面路径相同时：true：重新加载页面 false：保留原页面状态
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>reload: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">bool</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">type</span> <span style="color:#0a8;font-weight:bold">WebAppPath</span><span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span><span style="color:#366">String</span>;<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">type</span> <span style="color:#0a8;font-weight:bold">WebAppQuery</span><span style="color:#bbb"> </span><span style="color:#555">=</span><span style="color:#bbb"> </span>HashMap<span style="color:#555">&lt;</span><span style="color:#366">String</span>,<span style="color:#bbb"> </span><span style="color:#366">String</span><span style="color:#555">&gt;</span>;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 打开H5应用的容器模式
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">QueryWebAppMode</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 在工作台打开，3.20版本开始支持（缺省值）
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;appCenter&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>AppCenter,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 在独立窗口打开，3.20版本开始支持
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;window&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Window,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 在侧边栏打开，3.40版本开始支持
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;sidebar&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>SideBar,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 在独立窗口以小屏形式打开，5.10版本开始支持
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;window-semi&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>WindowSemi,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 打开聊天应用 参数 openID与openChatId 仅能填写其中一个参数。
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">QueryChat</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 用户 openId，获取方式可以参考文档：如何获得 User ID、Open ID 和 Union ID？
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;openId&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>open_id: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 会话ID，包括单聊会话和群聊会话。是以 &#39;oc&#39; 开头的字段,获取方式可参考文档 群ID说明；示例值： oc_41e7bdf4877cfc316136f4ccf6c32613
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;openChatId&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>open_chat_id: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 打开日历 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">QueryCalendarView</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 视图类型
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;type&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>type_: <span style="color:#366">Option</span><span style="color:#555">&lt;</span>QueryCalendarViewType<span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 日期，{unixTime}格式
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>date: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">u64</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 视图类型
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">QueryCalendarViewType</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 日视图
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;day&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Day,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 三日视图，仅移动端支持
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;three_day&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>ThreeDay,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 周视图，仅PC端支持
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;week&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Week,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 月视图
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;month&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Month,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 会议室视图，仅PC端支持
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;meeting&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Meeting,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 列表视图，仅移动端支持
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;list&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>List,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 打开日程创建页 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">QueryCalendarEventCreate</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 开始日期，{unixTime}格式
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;startTime&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>start_time: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">u64</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 结束日期，{unixTime}格式
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;endTime&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>end_time: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">u64</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 日程主题，中文可使用encodeURIComponent方法生成
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>summary: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 打开任务详情 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">QueryTodoDetail</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 全局唯一的taskId（global unique ID）,通过飞书任务的 OpenAPI 获取
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>guid: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 默认在im场景下，打开任务详情页面；mode=app, 在任务tab中打开详情页面
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>mode: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#366">String</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 打开任务tab页 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">QueryTodoView</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>tab: <span style="color:#0a8;font-weight:bold">QueryTodoViewTab</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 任务tab页
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">QueryTodoViewTab</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 进行中
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;all&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>All,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 由我处理
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;assign_to_me&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>AssignToMe,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 我分配的
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;assign_from_me&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>AssignFromMe,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 我关注的
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;followed&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Followed,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 已完成
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;completed&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Completed,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 打开云文档 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">QueryDocs</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 要打开的云文档URL
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;appId&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>url: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 打开机器人会话 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">QueryBot</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 机器人的appId
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;appId&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>app_id: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 打开SSO登录页 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">QueryPassportSsoLogin</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 租户的域名，填写的是租户在admin后台配置的租户域名信息。当在admin后台改动租户的域名时，需要同步修改applink该参数值
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>sso_domain: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 租户名，用于在切换租户时，客户端展示即将登录到的租户名称，一般填写公司名即可
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>tenant_name: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// 打开PC端内web-view访问指定URL 参数
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">struct</span> <span style="color:#0a8;font-weight:bold">QueryWebUrl</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 指定需要在客户端内打开的具体链接，需要执行encodeURIComponent，4.2+版本支持lark协议
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>url: <span style="color:#366">String</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// PC端打开的容器模式
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>mode: <span style="color:#0a8;font-weight:bold">QueryWebUrlMode</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// PC端自定义独立窗口高度
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>height: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">u32</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// PC端自定义独立窗口宽度
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span>width: <span style="color:#366">Option</span><span style="color:#555">&lt;</span><span style="color:#078;font-weight:bold">u32</span><span style="color:#555">&gt;</span>,<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#c30;font-style:italic">/// PC端打开的容器模式
</span><span style="color:#c30;font-style:italic"></span><span style="color:#099">#[derive(Debug, Clone, Deserialize, Serialize, JsonSchema)]</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#069;font-weight:bold">pub</span><span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">QueryWebUrlMode</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 在侧边栏打开
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;sidebar-semi&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>SidebarSemi,<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#c30;font-style:italic">/// 在独立窗口打开
</span><span style="color:#c30;font-style:italic"></span><span style="color:#bbb">    </span><span style="color:#099">#[serde(rename = </span><span style="color:#c30">&#34;window&#34;</span><span style="color:#099">)]</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>Window,<span style="color:#bbb">
</span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></code></pre></div><p>AppLink 这部分内容并未完全准确实现，还剩下一些东西没仔细看，最近是没空看了。</p>
<p>到这里，三大主要平台的消息通知的格式就基本都用 Rust 声明过了，只要是通过这些个结构去生成的数据，然后通过 <code>let message = serde_json::to_string(&amp;msg)</code> 所得到的数据，就一定是符合平台格式要求的。</p>
<p>当然这里还有很多事情没有做：例如长度问题、大小问题等等，如果要完善，就得再实现一些检查函数和数据处理函数了，那要总结规律然后设计统一的校验协议然后按规范实现才是最好，而暂时认为没有太大的必要性。</p>
<p>飞书的消息结构虽然看似复杂，但是其实是结构对象比较多，它通过各种组合关系，能形成极为丰富的组合效果，所以甚至是飞书官方，都提供了一个非常友好的消息卡片搭建工具来供大家使用，它就是一个 json 生成器，大多数业务，基本拿到这个 json 结果就可以去接入并发送消息了，而并不需要类似我这样去完整地声明它的全部数据结构。</p>
<p>但，始终有一天，你会遇到与我类似的痛苦和类似的需求的，那时候可能你会明白，我这么做的意义在哪里。</p>
<p>到此，你会发现，Rust 如此强大的强类型数据结构声明的能力，是多么的漂亮，哪怕是面对消息通知这种极为复杂的充满无限可能性的业务场景下，都能做到如此让人惊呼的实现，而这种体验，我在 Python 和 Goland 从未有过。</p>
<p>加油吧，朋友们。</p>

    </article>


                  </div>
                </div>
              </div>


        <footer class="site-footer">
    

        <div class="container">
            <hr>
            

<div class="row" style="margin-top:2rem;margin-bottom:2rem">


<div class="col-sm-2">
<div class="card border-light bg-light">
<div class="view overlay hm-white-slight">
<img src="/assets/img/Jeremy.jpg" class="card-img img-fluid float-left" alt="">
</div>
</div>
</div>



<div class="col-sm-10">
<h5><a href="/about">Jeremy Yin</a></h5>
<p>Python Engineer, Business System Architect</p>
<ul class="list-unstyled">
<li><a href="https://github.com/jeremyyin2012" target="_blank">
    <span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span>
</a>
</li>
</ul>
<p>友情链接：<a href="https://www.2haohr.com/" target="_blank">2号人事部</a></p>
</div>



</div>


      
          <div class="footer left column one-half">
            <section class="small-font">
                    Copyright © Since 2016 <a href="/">Jeremy's blog</a> All Rights Reserved.
                    <a id="icp_link" target="_blank"
                      href="http://beian.miit.gov.cn"><span>粤ICP备18138486号-1</span></a>
            </section>
          </div>
        </div>

      </footer>

        
<script src="/mdb/js/jquery-3.2.1.min.js"></script>
<script src="/mdb/js/popper.min.js"></script>
<script src="/bootstrap/js/bootstrap.min.js"></script>
<script src="/mdb/js/mdb.min.js"></script>
<script src="/assets/evil-icons.min.js"></script>
<script src="/jeremy/js/main.js"></script>
<script src="/jeremy/js/icp.js"></script>

        
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-92987034-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


    </body>

</html>